import { Language } from '../context/LanguageContext';

// News content translations
export const newsTranslations = {
  en: {
    // Common news terms
    'readMore': 'Read More',
    'readLess': 'Read Less',
    'publishedOn': 'Published on',
    'author': 'Author',
    'category': 'Category',
    'tags': 'Tags',
    'share': 'Share',
    'comment': 'Comment',
    'comments': 'Comments',
    'like': 'Like',
    'likes': 'Likes',
    'view': 'View',
    'views': 'Views',
    'trending': 'Trending',
    'latest': 'Latest',
    'popular': 'Popular',
    'featured': 'Featured',
    'breaking': 'Breaking',
    'exclusive': 'Exclusive',
    'analysis': 'Analysis',
    'opinion': 'Opinion',
    'report': 'Report',
    'announcement': 'Announcement',
    
    // Market related
    'marketCap': 'Market Cap',
    'volume24h': '24h Volume',
    'priceChange': 'Price Change',
    'circulatingSupply': 'Circulating Supply',
    'totalSupply': 'Total Supply',
    'allTimeHigh': 'All Time High',
    'allTimeLow': 'All Time Low',
    
    // Time related
    'justNow': 'Just Now',
    'minutesAgo': 'minutes ago',
    'hoursAgo': 'hours ago',
    'daysAgo': 'days ago',
    'weeksAgo': 'weeks ago',
    'monthsAgo': 'months ago',
    'yearsAgo': 'years ago',
    
    // Actions
    'subscribe': 'Subscribe',
    'unsubscribe': 'Unsubscribe',
    'bookmark': 'Bookmark',
    'bookmarked': 'Bookmarked',
    'follow': 'Follow',
    'following': 'Following',
    'unfollow': 'Unfollow',
    'save': 'Save',
    'saved': 'Saved',
    'delete': 'Delete',
    'edit': 'Edit',
    'create': 'Create',
    'update': 'Update',
    'cancel': 'Cancel',
    'confirm': 'Confirm',
    'submit': 'Submit',
    'search': 'Search',
    'filter': 'Filter',
    'sort': 'Sort',
    'refresh': 'Refresh',
    'loadMore': 'Load More',
    'showMore': 'Show More',
    'showLess': 'Show Less',
  },
  hi: {
    // Common news terms in Hindi
    'readMore': 'और पढ़ें',
    'readLess': 'कम पढ़ें',
    'publishedOn': 'प्रकाशित',
    'author': 'लेखक',
    'category': 'श्रेणी',
    'tags': 'टैग',
    'share': 'शेयर करें',
    'comment': 'टिप्पणी',
    'comments': 'टिप्पणियां',
    'like': 'लाइक',
    'likes': 'लाइक्स',
    'view': 'देखें',
    'views': 'व्यूज़',
    'trending': 'ट्रेंडिंग',
    'latest': 'नवीनतम',
    'popular': 'लोकप्रिय',
    'featured': 'विशेष',
    'breaking': 'ब्रेकिंग',
    'exclusive': 'विशेष',
    'analysis': 'विश्लेषण',
    'opinion': 'राय',
    'report': 'रिपोर्ट',
    'announcement': 'घोषणा',
    
    // Market related in Hindi
    'marketCap': 'बाजार पूंजी',
    'volume24h': '24 घंटे का वॉल्यूम',
    'priceChange': 'मूल्य परिवर्तन',
    'circulatingSupply': 'चल रही आपूर्ति',
    'totalSupply': 'कुल आपूर्ति',
    'allTimeHigh': 'सर्वकालिक उच्च',
    'allTimeLow': 'सर्वकालिक निम्न',
    
    // Time related in Hindi
    'justNow': 'अभी-अभी',
    'minutesAgo': 'मिनट पहले',
    'hoursAgo': 'घंटे पहले',
    'daysAgo': 'दिन पहले',
    'weeksAgo': 'सप्ताह पहले',
    'monthsAgo': 'महीने पहले',
    'yearsAgo': 'साल पहले',
    
    // Actions in Hindi
    'subscribe': 'सदस्यता लें',
    'unsubscribe': 'सदस्यता रद्द करें',
    'bookmark': 'बुकमार्क',
    'bookmarked': 'बुकमार्क किया गया',
    'follow': 'फॉलो करें',
    'following': 'फॉलो कर रहे हैं',
    'unfollow': 'अनफॉलो करें',
    'save': 'सहेजें',
    'saved': 'सहेजा गया',
    'delete': 'हटाएं',
    'edit': 'संपादित करें',
    'create': 'बनाएं',
    'update': 'अपडेट करें',
    'cancel': 'रद्द करें',
    'confirm': 'पुष्टि करें',
    'submit': 'जमा करें',
    'search': 'खोजें',
    'filter': 'फ़िल्टर',
    'sort': 'क्रमबद्ध करें',
    'refresh': 'रिफ्रेश करें',
    'loadMore': 'और लोड करें',
    'showMore': 'और दिखाएं',
    'showLess': 'कम दिखाएं',
  },
  es: {
    // Common news terms in Spanish
    'readMore': 'Leer Más',
    'readLess': 'Leer Menos',
    'publishedOn': 'Publicado el',
    'author': 'Autor',
    'category': 'Categoría',
    'tags': 'Etiquetas',
    'share': 'Compartir',
    'comment': 'Comentario',
    'comments': 'Comentarios',
    'like': 'Me Gusta',
    'likes': 'Me Gusta',
    'view': 'Ver',
    'views': 'Vistas',
    'trending': 'Tendencia',
    'latest': 'Últimas',
    'popular': 'Popular',
    'featured': 'Destacado',
    'breaking': 'Última Hora',
    'exclusive': 'Exclusivo',
    'analysis': 'Análisis',
    'opinion': 'Opinión',
    'report': 'Reporte',
    'announcement': 'Anuncio',
    
    // Market related in Spanish
    'marketCap': 'Capitalización de Mercado',
    'volume24h': 'Volumen 24h',
    'priceChange': 'Cambio de Precio',
    'circulatingSupply': 'Oferta Circulante',
    'totalSupply': 'Oferta Total',
    'allTimeHigh': 'Máximo Histórico',
    'allTimeLow': 'Mínimo Histórico',
    
    // Time related in Spanish
    'justNow': 'Ahora Mismo',
    'minutesAgo': 'minutos atrás',
    'hoursAgo': 'horas atrás',
    'daysAgo': 'días atrás',
    'weeksAgo': 'semanas atrás',
    'monthsAgo': 'meses atrás',
    'yearsAgo': 'años atrás',
    
    // Actions in Spanish
    'subscribe': 'Suscribirse',
    'unsubscribe': 'Cancelar Suscripción',
    'bookmark': 'Marcador',
    'bookmarked': 'Marcado',
    'follow': 'Seguir',
    'following': 'Siguiendo',
    'unfollow': 'Dejar de Seguir',
    'save': 'Guardar',
    'saved': 'Guardado',
    'delete': 'Eliminar',
    'edit': 'Editar',
    'create': 'Crear',
    'update': 'Actualizar',
    'cancel': 'Cancelar',
    'confirm': 'Confirmar',
    'submit': 'Enviar',
    'search': 'Buscar',
    'filter': 'Filtrar',
    'sort': 'Ordenar',
    'refresh': 'Actualizar',
    'loadMore': 'Cargar Más',
    'showMore': 'Mostrar Más',
    'showLess': 'Mostrar Menos',
  },
  fr: {
    // Common news terms in French
    'readMore': 'Lire Plus',
    'readLess': 'Lire Moins',
    'publishedOn': 'Publié le',
    'author': 'Auteur',
    'category': 'Catégorie',
    'tags': 'Tags',
    'share': 'Partager',
    'comment': 'Commentaire',
    'comments': 'Commentaires',
    'like': 'J\'aime',
    'likes': 'J\'aime',
    'view': 'Voir',
    'views': 'Vues',
    'trending': 'Tendance',
    'latest': 'Dernières',
    'popular': 'Populaire',
    'featured': 'À la Une',
    'breaking': 'Dernière Minute',
    'exclusive': 'Exclusif',
    'analysis': 'Analyse',
    'opinion': 'Opinion',
    'report': 'Rapport',
    'announcement': 'Annonce',
    
    // Market related in French
    'marketCap': 'Capitalisation Boursière',
    'volume24h': 'Volume 24h',
    'priceChange': 'Variation de Prix',
    'circulatingSupply': 'Offre en Circulation',
    'totalSupply': 'Offre Totale',
    'allTimeHigh': 'Plus Haut Historique',
    'allTimeLow': 'Plus Bas Historique',
    
    // Time related in French
    'justNow': 'À l\'Instant',
    'minutesAgo': 'minutes',
    'hoursAgo': 'heures',
    'daysAgo': 'jours',
    'weeksAgo': 'semaines',
    'monthsAgo': 'mois',
    'yearsAgo': 'années',
    
    // Actions in French
    'subscribe': 'S\'abonner',
    'unsubscribe': 'Se Désabonner',
    'bookmark': 'Marquer',
    'bookmarked': 'Marqué',
    'follow': 'Suivre',
    'following': 'Suivant',
    'unfollow': 'Ne Plus Suivre',
    'save': 'Sauvegarder',
    'saved': 'Sauvegardé',
    'delete': 'Supprimer',
    'edit': 'Modifier',
    'create': 'Créer',
    'update': 'Mettre à Jour',
    'cancel': 'Annuler',
    'confirm': 'Confirmer',
    'submit': 'Soumettre',
    'search': 'Rechercher',
    'filter': 'Filtrer',
    'sort': 'Trier',
    'refresh': 'Actualiser',
    'loadMore': 'Charger Plus',
    'showMore': 'Afficher Plus',
    'showLess': 'Afficher Moins',
  },
  de: {
    // Common news terms in German
    'readMore': 'Mehr Lesen',
    'readLess': 'Weniger Lesen',
    'publishedOn': 'Veröffentlicht am',
    'author': 'Autor',
    'category': 'Kategorie',
    'tags': 'Tags',
    'share': 'Teilen',
    'comment': 'Kommentar',
    'comments': 'Kommentare',
    'like': 'Gefällt Mir',
    'likes': 'Gefällt Mir',
    'view': 'Ansehen',
    'views': 'Aufrufe',
    'trending': 'Trend',
    'latest': 'Neueste',
    'popular': 'Beliebt',
    'featured': 'Empfohlen',
    'breaking': 'Eilmeldung',
    'exclusive': 'Exklusiv',
    'analysis': 'Analyse',
    'opinion': 'Meinung',
    'report': 'Bericht',
    'announcement': 'Ankündigung',
    
    // Market related in German
    'marketCap': 'Marktkapitalisierung',
    'volume24h': '24h Volumen',
    'priceChange': 'Preisänderung',
    'circulatingSupply': 'Umlaufende Menge',
    'totalSupply': 'Gesamtmenge',
    'allTimeHigh': 'Allzeit-Hoch',
    'allTimeLow': 'Allzeit-Tief',
    
    // Time related in German
    'justNow': 'Gerade Jetzt',
    'minutesAgo': 'Minuten',
    'hoursAgo': 'Stunden',
    'daysAgo': 'Tage',
    'weeksAgo': 'Wochen',
    'monthsAgo': 'Monate',
    'yearsAgo': 'Jahre',
    
    // Actions in German
    'subscribe': 'Abonnieren',
    'unsubscribe': 'Abbestellen',
    'bookmark': 'Lesezeichen',
    'bookmarked': 'Lesezeichen',
    'follow': 'Folgen',
    'following': 'Folgt',
    'unfollow': 'Nicht Mehr Folgen',
    'save': 'Speichern',
    'saved': 'Gespeichert',
    'delete': 'Löschen',
    'edit': 'Bearbeiten',
    'create': 'Erstellen',
    'update': 'Aktualisieren',
    'cancel': 'Abbrechen',
    'confirm': 'Bestätigen',
    'submit': 'Absenden',
    'search': 'Suchen',
    'filter': 'Filtern',
    'sort': 'Sortieren',
    'refresh': 'Aktualisieren',
    'loadMore': 'Mehr Laden',
    'showMore': 'Mehr Anzeigen',
    'showLess': 'Weniger Anzeigen',
  },
  zh: {
    // Common news terms in Chinese
    'readMore': '阅读更多',
    'readLess': '收起',
    'publishedOn': '发布于',
    'author': '作者',
    'category': '分类',
    'tags': '标签',
    'share': '分享',
    'comment': '评论',
    'comments': '评论',
    'like': '点赞',
    'likes': '点赞',
    'view': '查看',
    'views': '查看',
    'trending': '热门',
    'latest': '最新',
    'popular': '热门',
    'featured': '精选',
    'breaking': '突发',
    'exclusive': '独家',
    'analysis': '分析',
    'opinion': '观点',
    'report': '报告',
    'announcement': '公告',
    
    // Market related in Chinese
    'marketCap': '市值',
    'volume24h': '24小时成交量',
    'priceChange': '价格变化',
    'circulatingSupply': '流通供应量',
    'totalSupply': '总供应量',
    'allTimeHigh': '历史最高',
    'allTimeLow': '历史最低',
    
    // Time related in Chinese
    'justNow': '刚刚',
    'minutesAgo': '分钟前',
    'hoursAgo': '小时前',
    'daysAgo': '天前',
    'weeksAgo': '周前',
    'monthsAgo': '个月前',
    'yearsAgo': '年前',
    
    // Actions in Chinese
    'subscribe': '订阅',
    'unsubscribe': '取消订阅',
    'bookmark': '书签',
    'bookmarked': '已书签',
    'follow': '关注',
    'following': '已关注',
    'unfollow': '取消关注',
    'save': '保存',
    'saved': '已保存',
    'delete': '删除',
    'edit': '编辑',
    'create': '创建',
    'update': '更新',
    'cancel': '取消',
    'confirm': '确认',
    'submit': '提交',
    'search': '搜索',
    'filter': '筛选',
    'sort': '排序',
    'refresh': '刷新',
    'loadMore': '加载更多',
    'showMore': '显示更多',
    'showLess': '收起',
  },
  ja: {
    // Common news terms in Japanese
    'readMore': '続きを読む',
    'readLess': '閉じる',
    'publishedOn': '公開日',
    'author': '著者',
    'category': 'カテゴリー',
    'tags': 'タグ',
    'share': 'シェア',
    'comment': 'コメント',
    'comments': 'コメント',
    'like': 'いいね',
    'likes': 'いいね',
    'view': '表示',
    'views': '表示',
    'trending': 'トレンド',
    'latest': '最新',
    'popular': '人気',
    'featured': '特集',
    'breaking': '速報',
    'exclusive': '独占',
    'analysis': '分析',
    'opinion': '意見',
    'report': 'レポート',
    'announcement': 'お知らせ',
    
    // Market related in Japanese
    'marketCap': '時価総額',
    'volume24h': '24時間取引量',
    'priceChange': '価格変動',
    'circulatingSupply': '流通供給量',
    'totalSupply': '総供給量',
    'allTimeHigh': '史上最高',
    'allTimeLow': '史上最低',
    
    // Time related in Japanese
    'justNow': '今',
    'minutesAgo': '分前',
    'hoursAgo': '時間前',
    'daysAgo': '日前',
    'weeksAgo': '週間前',
    'monthsAgo': 'ヶ月前',
    'yearsAgo': '年前',
    
    // Actions in Japanese
    'subscribe': '購読',
    'unsubscribe': '購読解除',
    'bookmark': 'ブックマーク',
    'bookmarked': 'ブックマーク済み',
    'follow': 'フォロー',
    'following': 'フォロー中',
    'unfollow': 'フォロー解除',
    'save': '保存',
    'saved': '保存済み',
    'delete': '削除',
    'edit': '編集',
    'create': '作成',
    'update': '更新',
    'cancel': 'キャンセル',
    'confirm': '確認',
    'submit': '送信',
    'search': '検索',
    'filter': 'フィルター',
    'sort': '並び替え',
    'refresh': '更新',
    'loadMore': 'もっと見る',
    'showMore': 'もっと表示',
    'showLess': '閉じる',
  },
  ko: {
    // Common news terms in Korean
    'readMore': '더 보기',
    'readLess': '접기',
    'publishedOn': '게시일',
    'author': '작성자',
    'category': '카테고리',
    'tags': '태그',
    'share': '공유',
    'comment': '댓글',
    'comments': '댓글',
    'like': '좋아요',
    'likes': '좋아요',
    'view': '보기',
    'views': '보기',
    'trending': '트렌딩',
    'latest': '최신',
    'popular': '인기',
    'featured': '추천',
    'breaking': '속보',
    'exclusive': '독점',
    'analysis': '분석',
    'opinion': '의견',
    'report': '보고서',
    'announcement': '공지사항',
    
    // Market related in Korean
    'marketCap': '시가총액',
    'volume24h': '24시간 거래량',
    'priceChange': '가격 변동',
    'circulatingSupply': '유통 공급량',
    'totalSupply': '총 공급량',
    'allTimeHigh': '역대 최고',
    'allTimeLow': '역대 최저',
    
    // Time related in Korean
    'justNow': '방금',
    'minutesAgo': '분 전',
    'hoursAgo': '시간 전',
    'daysAgo': '일 전',
    'weeksAgo': '주 전',
    'monthsAgo': '개월 전',
    'yearsAgo': '년 전',
    
    // Actions in Korean
    'subscribe': '구독',
    'unsubscribe': '구독 취소',
    'bookmark': '북마크',
    'bookmarked': '북마크됨',
    'follow': '팔로우',
    'following': '팔로우 중',
    'unfollow': '언팔로우',
    'save': '저장',
    'saved': '저장됨',
    'delete': '삭제',
    'edit': '편집',
    'create': '생성',
    'update': '업데이트',
    'cancel': '취소',
    'confirm': '확인',
    'submit': '제출',
    'search': '검색',
    'filter': '필터',
    'sort': '정렬',
    'refresh': '새로고침',
    'loadMore': '더 보기',
    'showMore': '더 표시',
    'showLess': '접기',
  },
  ar: {
    // Common news terms in Arabic
    'readMore': 'اقرأ المزيد',
    'readLess': 'اقرأ أقل',
    'publishedOn': 'نشر في',
    'author': 'الكاتب',
    'category': 'الفئة',
    'tags': 'العلامات',
    'share': 'مشاركة',
    'comment': 'تعليق',
    'comments': 'التعليقات',
    'like': 'إعجاب',
    'likes': 'إعجاب',
    'view': 'عرض',
    'views': 'عرض',
    'trending': 'رائج',
    'latest': 'الأحدث',
    'popular': 'شائع',
    'featured': 'مميز',
    'breaking': 'عاجل',
    'exclusive': 'حصري',
    'analysis': 'تحليل',
    'opinion': 'رأي',
    'report': 'تقرير',
    'announcement': 'إعلان',
    
    // Market related in Arabic
    'marketCap': 'القيمة السوقية',
    'volume24h': 'حجم التداول 24 ساعة',
    'priceChange': 'تغير السعر',
    'circulatingSupply': 'العرض المتداول',
    'totalSupply': 'العرض الإجمالي',
    'allTimeHigh': 'أعلى مستوى تاريخي',
    'allTimeLow': 'أدنى مستوى تاريخي',
    
    // Time related in Arabic
    'justNow': 'الآن',
    'minutesAgo': 'دقائق',
    'hoursAgo': 'ساعات',
    'daysAgo': 'أيام',
    'weeksAgo': 'أسابيع',
    'monthsAgo': 'أشهر',
    'yearsAgo': 'سنوات',
    
    // Actions in Arabic
    'subscribe': 'اشتراك',
    'unsubscribe': 'إلغاء الاشتراك',
    'bookmark': 'إشارة مرجعية',
    'bookmarked': 'إشارة مرجعية',
    'follow': 'متابعة',
    'following': 'متابع',
    'unfollow': 'إلغاء المتابعة',
    'save': 'حفظ',
    'saved': 'محفوظ',
    'delete': 'حذف',
    'edit': 'تعديل',
    'create': 'إنشاء',
    'update': 'تحديث',
    'cancel': 'إلغاء',
    'confirm': 'تأكيد',
    'submit': 'إرسال',
    'search': 'بحث',
    'filter': 'تصفية',
    'sort': 'ترتيب',
    'refresh': 'تحديث',
    'loadMore': 'تحميل المزيد',
    'showMore': 'عرض المزيد',
    'showLess': 'عرض أقل',
  }
};

// News translation cache to store translated content
interface NewsTranslationCache {
  [key: string]: {
    [language: string]: {
      title: string;
      description: string;
      timestamp: number;
    };
  };
}

// Initialize translation cache from localStorage
let newsTranslationCache: NewsTranslationCache = {};
try {
  const cached = localStorage.getItem('newsTranslationCache');
  if (cached) {
    newsTranslationCache = JSON.parse(cached);
  }
} catch (error) {
  console.warn('Failed to load news translation cache:', error);
}

// Save cache to localStorage
const saveCache = () => {
  try {
    localStorage.setItem('newsTranslationCache', JSON.stringify(newsTranslationCache));
  } catch (error) {
    console.warn('Failed to save news translation cache:', error);
  }
};

// Generate cache key for news content
const generateCacheKey = (content: string, language: string): string => {
  return `${language}_${content.substring(0, 50).replace(/[^a-zA-Z0-9]/g, '')}`;
};

// Check if cache is still valid (24 hours)
const isCacheValid = (timestamp: number): boolean => {
  return Date.now() - timestamp < 24 * 60 * 60 * 1000;
};

// Function to translate news content using Google Translate API (free tier)
export const translateNewsContent = async (content: string, targetLanguage: Language): Promise<string> => {
  if (targetLanguage === 'en') {
    return content; // Return original content for English
  }

  // Check cache first
  const cacheKey = generateCacheKey(content, targetLanguage);
  if (newsTranslationCache[cacheKey] && isCacheValid(newsTranslationCache[cacheKey][targetLanguage].timestamp)) {
    return newsTranslationCache[cacheKey][targetLanguage].title;
  }

  try {
    // Use Google Translate API (free tier with limitations)
    const response = await fetch(`https://translate.googleapis.com/translate_a/single?client=gtx&sl=en&tl=${targetLanguage}&dt=t&q=${encodeURIComponent(content)}`);
    
    if (!response.ok) {
      throw new Error(`Translation API error: ${response.status}`);
    }

    const data = await response.json();
    let translatedText = '';

    // Extract translated text from response
    if (data && data[0] && Array.isArray(data[0])) {
      translatedText = data[0].map((item: any) => item[0]).join('');
    }

    if (translatedText && translatedText !== content) {
      // Cache the translation
      if (!newsTranslationCache[cacheKey]) {
        newsTranslationCache[cacheKey] = {};
      }
      newsTranslationCache[cacheKey][targetLanguage] = {
        title: translatedText,
        description: translatedText,
        timestamp: Date.now()
      };
      saveCache();
      return translatedText;
    }
  } catch (error) {
    console.warn('Translation API failed, using fallback:', error);
  }

  // Fallback: return placeholder with language name
  const languageNames = {
    'hi': 'Hindi',
    'es': 'Spanish',
    'fr': 'French',
    'de': 'German',
    'zh': 'Chinese',
    'ja': 'Japanese',
    'ko': 'Korean',
    'ar': 'Arabic'
  };
  
  const langName = languageNames[targetLanguage] || targetLanguage;
  return `[${langName} Translation] ${content}`;
};

// Function to translate news item (title and description)
export const translateNewsItem = async (newsItem: any, targetLanguage: Language): Promise<any> => {
  if (targetLanguage === 'en') {
    return newsItem; // Return original for English
  }

  try {
    const [translatedTitle, translatedDescription] = await Promise.all([
      translateNewsContent(newsItem.title || '', targetLanguage),
      translateNewsContent(newsItem.description || '', targetLanguage)
    ]);

    return {
      ...newsItem,
      title: translatedTitle,
      description: translatedDescription
    };
  } catch (error) {
    console.warn('Failed to translate news item:', error);
    return newsItem; // Return original if translation fails
  }
};

// Function to translate common terms
export const translateTerm = (term: string, targetLanguage: Language): string => {
  const translations = newsTranslations[targetLanguage];
  return translations[term as keyof typeof translations] || term;
};

// Function to format time with translation
export const formatTimeAgo = (timestamp: Date, targetLanguage: Language): string => {
  const now = new Date();
  const diffInMs = now.getTime() - timestamp.getTime();
  const diffInMinutes = Math.floor(diffInMs / (1000 * 60));
  const diffInHours = Math.floor(diffInMs / (1000 * 60 * 60));
  const diffInDays = Math.floor(diffInMs / (1000 * 60 * 60 * 24));
  
  if (diffInMinutes < 1) {
    return translateTerm('justNow', targetLanguage);
  } else if (diffInMinutes < 60) {
    return `${diffInMinutes} ${translateTerm('minutesAgo', targetLanguage)}`;
  } else if (diffInHours < 24) {
    return `${diffInHours} ${translateTerm('hoursAgo', targetLanguage)}`;
  } else if (diffInDays < 7) {
    return `${diffInDays} ${translateTerm('daysAgo', targetLanguage)}`;
  } else {
    return timestamp.toLocaleDateString(targetLanguage === 'hi' ? 'hi-IN' : 'en-US');
  }
};

// Function to clear translation cache
export const clearTranslationCache = (): void => {
  newsTranslationCache = {};
  localStorage.removeItem('newsTranslationCache');
};

// Function to get cache statistics
export const getCacheStats = (): { totalEntries: number; languages: string[] } => {
  const languages = new Set<string>();
  let totalEntries = 0;

  Object.values(newsTranslationCache).forEach(entry => {
    Object.keys(entry).forEach(lang => {
      languages.add(lang);
      totalEntries++;
    });
  });

  return {
    totalEntries,
    languages: Array.from(languages)
  };
};
